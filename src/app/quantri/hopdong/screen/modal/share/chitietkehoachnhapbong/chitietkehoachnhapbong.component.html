<div class="modal-header">
    <h5 class="modal-title">Kế hoạch nhập bông</h5>
    <!-- <div class="p-col-12 p-lg-4 p-p-0 d-flex flex-column flex-lg-row">
        <label class="p-col-12 p-lg-4 p-p-0 my-auto">Nhà máy:</label>
        <div class="p-col-12 p-lg-8 p-p-0">
            <p-dropdown [filter]="true" [options]="listNhaMay" placeholder="Chọn nhà máy" styleClass="p-inputtext-sm"
                [(ngModel)]="item.NhaMay"></p-dropdown>
        </div>
    </div> -->
    <div class="d-flex flex-column flex-lg-row">
        <p-dropdown [filter]="true" [options]="listduan" placeholder="Chọn dự án" [(ngModel)]="item.idDuAn"
            styleClass="p-inputtext-sm" (onChange)="GetDanhSachHopDongByNhaThau()"></p-dropdown>
    </div>
    <button *ngIf="false" type="button" class="close" aria-label="Close" (click)="Onclose()">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
<div class="modal-body">
    <div class="p-d-flex p-flex-row p-jc-between">
        <div class="modal-bt p-mb-4 ">
            <button pButton pRipple type="button" label="Quay lại" class="p-mr-2 p-button-sm"
                (click)="Onclose()"></button>
            <button pButton pRipple type="button" label="Ghi lại" class="p-mr-2 p-button-sm " (click)="GhiLai()"
                *ngIf="checkbutton.Ghi"></button>
            <button pButton pRipple type="button" label="Xóa" class="p-mr-2 p-button-sm" *ngIf="checkbutton.Xoa"
                (click)="XoaQuyTrinh()"></button>
            <button pButton pRipple type="button" label="Không duyệt" class="p-mr-2 p-button-sm" (click)="KhongDuyet()"
                *ngIf="checkbutton.KhongDuyet"></button>
            <button pButton pRipple type="button" label="Chuyển duyệt" class="p-mr-2 p-button-sm"
                (click)="ChuyenDuyet()" *ngIf="checkbutton.ChuyenTiep"></button>
        </div>

        <div class="modal-bt p-mb-4 ">
            <div>
                <span style="font-weight: bold;">Số phiếu:</span> {{item.soQuyTrinh}}
                <span style="font-weight: bold;">Thời gian Tạo:</span> {{item.created|date:"dd/MM/yyyy HH:mm"}}
            </div>
            <div>

            </div>
        </div>
    </div>
    <p-panel header="Thông tin kế hoạch nhập bông" styleClass="p-pl-0" [toggleable]="true">
        <div class="p-grid">
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Hợp đồng <span class="text-danger">*</span>:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-dropdown [filter]="true" [options]="listhopdong" placeholder="Chọn hợp đồng"
                        [(ngModel)]="item.idHopDong" styleClass="p-inputtext-sm"
                        (onChange)="GetListdmLoaiBongForHopDong()"></p-dropdown>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Loại bông/xơ:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <input type="text" class="p-inputtext-sm" [(ngModel)]="item.tenLoaiBongXo" pInputText disabled/>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Mã invoice:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <input type="text" class="p-inputtext-sm" [(ngModel)]="item.maInvoice" pInputText />
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Cấp bông:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <input type="text" class="p-inputtext-sm" [(ngModel)]="item.tendmCapBong" pInputText disabled/>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Thời gian cập cảng <span class="text-danger">*</span>:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-calendar dateFormat="dd/mm/yy" [locale]="lang" [monthNavigator]="true" [yearNavigator]="true"
                        [yearRange]="yearRange" [showIcon]="true" [(ngModel)]="item.thoiGianCapCang" inputId="icon"
                        placeholder="dd/mm/yyyy">
                    </p-calendar>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Thời gian dự kiến về kho <span class="text-danger">*</span>:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-calendar dateFormat="dd/mm/yy" [locale]="lang" [monthNavigator]="true" [yearNavigator]="true"
                        [yearRange]="yearRange" [showIcon]="true" [(ngModel)]="item.thoiGianDuKien" inputId="icon"
                        placeholder="dd/mm/yyyy">
                    </p-calendar>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Đặc tính bông:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <input type="text" class="p-inputtext-sm" [(ngModel)]="item.dacTinhBong" pInputText disabled/>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Giá CIF:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="item.giaCif" disabled>
                    </p-inputNumber>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Số lượng (kg):</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="item.soLuong" disabled>
                    </p-inputNumber>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Số container:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="item.soContainer" disabled>
                    </p-inputNumber>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Số kiện:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="item.soKien" disabled>
                    </p-inputNumber>
                </div>
            </div>
            <div class="p-col-12 p-lg-6 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-3 p-p-0 my-auto">Nội dung:</label>
                <div class="p-col-12 p-lg-9 p-p-0">
                    <input type="text" class="p-inputtext-sm" [(ngModel)]="item.noiDung" pInputText />
                </div>
            </div>
            <div class="p-col-12 p-lg-12 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-1 p-p-0 my-auto">Ghi chú:</label>
                <div class="p-col-12 p-lg-11 p-p-0 p-pl-theokieunaodo">
                    <input type="text" class="p-inputtext-sm" [(ngModel)]="item.ghiChu" pInputText />
                </div>
            </div>
        </div>
    </p-panel>
    <p-panel header="Thông tin kế hoạch nhập invoice" [toggleable]="true">
        <div class="p-grid">
            <!-- <div class="p-col-12 p-lg-5 p-p-3 d-flex flex-column flex-lg-row">
                <label class="p-col-12 p-lg-2 p-p-0 my-auto">Kho <span class="text-danger">*</span>:</label>
                <div class="p-col-12 p-lg-10 p-p-0">
                    <p-dropdown [filter]="true" [options]="listKho" placeholder="Chọn kho" [(ngModel)]="item.IddmKho"
                        styleClass="p-inputtext-sm"></p-dropdown>
                </div>
            </div> -->

            <div class="p-col-12 p-p-0 d-flex flex-column" style="font-size: 12px;">
                <p-table [value]="item.listInvoice|isXoa|SortByKey:'thoiGianCapCangUnix'"
                    styleClass="p-datatable-sm wrap-text p-datatable-striped">
                    <ng-template pTemplate="colgroup">
                        <colgroup>
                            <col style="width:30px">
                            <col style="width:130px">
                            <col>
                            <col>
                            <col>
                            <col>
                            <col>
                            <col>
                            <col>
                            <col style="width: 50px;">
                        </colgroup>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th>#</th>
                            <th>Tên</th>
                            <th>Số lượng nhập (Kg)</th>
                            <th>Số lượng container</th>
                            <th>Số kiện</th>
                            <th>Thời gian cập cảng<span class="text-danger">*</span></th>
                            <th>Thời gian dự kiến về kho<span class="text-danger">*</span></th>
                            <th>Chọn kho<span class="text-danger">*</span></th>
                            <th>Ghi chú</th>
                            <th></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-items let-i="rowIndex">
                        <tr>
                            <td class="text-center">{{i+1}}</td>
                            <td>
                                <input pInputText type="text" [(ngModel)]="items.ten" />
                            </td>
                            <td>
                                <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="items.soLuong">
                                </p-inputNumber>
                            </td>
                            <td>
                                <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="items.soContainer">
                                </p-inputNumber>
                            </td>
                            <td>
                                <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="items.soKien">
                                </p-inputNumber>
                            </td>
                            <td>
                                <p-calendar dateFormat="dd/mm/yy" [locale]="lang" [monthNavigator]="true"
                                    [yearNavigator]="true" [yearRange]="yearRange" [showIcon]="false"
                                    [(ngModel)]="items.thoiGianCapCang" inputId="icon" placeholder="dd/mm/yyyy">
                                </p-calendar>
                            </td>
                            <td>
                                <p-calendar dateFormat="dd/mm/yy" [locale]="lang" [monthNavigator]="true"
                                    [yearNavigator]="true" [yearRange]="yearRange" [showIcon]="false"
                                    [(ngModel)]="items.thoiGianDuKien" inputId="icon" placeholder="dd/mm/yyyy">
                                </p-calendar>
                            </td>
                            <td>
                                <p-dropdown [filter]="true" [options]="listdmKho" placeholder="Chọn kho" [(ngModel)]="items.iddmKho"
                                    [showClear]="true" styleClass="p-inputtext-sm"></p-dropdown>
                            </td>
                            <td>
                                <input pInputText type="text" [(ngModel)]="items.ghiChu" />
                            </td>
                            <td class="text-center">
                                <button pButton pRipple icon="pi pi-times"
                                    class="p-button-sm p-button-rounded p-button-secondary p-button-text p-mr-2"
                                    (click)="delete(i)" pTooltip="Xóa" tooltipPosition="bottom"></button>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="footer" *ngIf="opt!=='modal'">
                        <tr>
                            <td>
                            </td>
                            <td>
                                <input pInputText type="text" [(ngModel)]="newTableItem.ten" />
                            </td>
                            <td>
                                <p-inputNumber [minFractionDigits]="0" locale="en-EN"
                                    [(ngModel)]="newTableItem.soLuong">
                                </p-inputNumber>
                            </td>
                            <td>
                                <p-inputNumber [minFractionDigits]="0" locale="en-EN"
                                    [(ngModel)]="newTableItem.soContainer">
                                </p-inputNumber>
                            </td>
                            <td>
                                <p-inputNumber [minFractionDigits]="0" locale="en-EN" [(ngModel)]="newTableItem.soKien">
                                </p-inputNumber>
                            </td>
                            <td>
                                <p-calendar dateFormat="dd/mm/yy" [locale]="lang" [monthNavigator]="true"
                                    [yearNavigator]="true" [yearRange]="yearRange" [showIcon]="false"
                                    [(ngModel)]="newTableItem.thoiGianCapCang" inputId="icon" placeholder="dd/mm/yyyy">
                                </p-calendar>
                            </td>
                            <td>
                                <p-calendar dateFormat="dd/mm/yy" [locale]="lang" [monthNavigator]="true"
                                    [yearNavigator]="true" [yearRange]="yearRange" [showIcon]="false"
                                    [(ngModel)]="newTableItem.thoiGianDuKien" inputId="icon" placeholder="dd/mm/yyyy">
                                </p-calendar>
                            </td>
                            <td>
                                <p-dropdown [filter]="true" [options]="listdmKho" placeholder="Chọn kho" [(ngModel)]="newTableItem.iddmKho"
                                    [showClear]="true" styleClass="p-inputtext-sm"></p-dropdown>
                            </td>
                            <td>
                                <input pInputText type="text" [(ngModel)]="newTableItem.ghiChu" />
                            </td>
                            <td class="text-center">
                                <button pButton pRipple type="button" icon="pi pi-plus"
                                    class="p-button-rounded p-button-sm " (click)="add()"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </p-panel>
</div>
<div class="modal-footer">
    <!-- <button pButton pRipple label="Chấp nhận" class="p-button-sm p-mr-2" (click)="accept()"></button>
    <button pButton pRipple label="Thoát" class="p-button-sm p-button-outlined p-button-secondary p-mr-2"
        (click)="activeModal.dismiss()"></button> -->
</div>